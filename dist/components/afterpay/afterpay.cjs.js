"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const A=require("react"),l=require("../../contexts/afterpay/afterpay.cjs.js"),m=require("../../hooks/use-event-listener.cjs.js"),E=require("../../contexts/form/form.cjs.js"),v=require("./afterpay.styles.cjs.js");function M(e){if(e&&e.__esModule)return e;const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const s in e)if(s!=="default"){const c=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,c.get?c:{enumerable:!0,get:()=>e[s]})}}return r.default=e,Object.freeze(r)}const t=M(A);function w({Button:e,buttonColor:r="black",buttonType:s="buy_now_with_afterpay",finalCtaButtonType:c="buy_now",id:a="rswps-afterpay-button",...f}){const u=t.useRef(null),n=l.useAfterpay(),{cardTokenizeResponseReceived:i}=E.useForm(),p=t.useMemo(()=>({buttonColor:r,buttonType:s,finalCtaButtonType:c,useCustomButton:Boolean(e)}),[e,r,s,c]),g=async y=>{if(y.stopPropagation(),!n){console.warn("Afterpay/Clearpay button was clicked, but no Afterpay/Clearpay instance was found.");return}try{const o=await n.tokenize();if(o.status==="OK")return i(o);let d=`Tokenization failed with status: ${o?.status}`;if(o?.errors)throw d+=` and errors: ${JSON.stringify(o?.errors)}`,new Error(d);console.warn(d)}catch(o){console.error(o)}};return t.useEffect(()=>(n&&n?.attach(`#${a}`,p),()=>{n&&n?.destroy()}),[n]),m.useEventListener({listener:g,type:"click",element:u,options:{passive:!0}}),e?t.createElement(e,{...f,id:a,ref:u}):t.createElement("div",{...f,id:a,ref:u},n?null:t.createElement(v.ButtonLoader,null))}function j({badgeTheme:e="black-on-mint",component:r,id:s="rswps-afterpay-message",modalLinkStyle:c="circled-info-icon",modalTheme:a="mint",size:f="md",...u}){const n=t.useRef(null),i=l.useAfterpay(),p=t.useMemo(()=>({badgeTheme:e,modalLinkStyle:c,modalTheme:a,size:f}),[e,c,a,f]);t.useEffect(()=>{const o=async()=>{await i?.attachMessaging(`#${s}`,p)};i&&!r?.Message&&o()},[i,r?.Message,p]);const g=async o=>{o.stopPropagation(),i?.displayInformationModal({modalTheme:a})};m.useEventListener({listener:g,type:"click",element:n,options:{passive:!0}});const y=r?.Message;return y?t.createElement(y,{...u,id:s,ref:n}):t.createElement("div",{...u,id:s})}function b({includeBranding:e,id:r="rswps-afterpay-widget",...s}){const c=t.useRef(null),a=l.useAfterpay();return t.useEffect(()=>{a&&(async()=>{await a?.attachCheckoutWidget(`#${r}`,{includeBranding:e})})()},[a,e]),t.createElement("div",{...s,id:r,ref:c})}function _(e){return t.createElement(l.default,null,t.createElement(w,{...e}))}exports.AfterpayContext=l.AfterpayContext;exports.AfterpayProvider=l.default;exports.AfterpayButton=w;exports.AfterpayMessage=j;exports.AfterpayWidget=b;exports.default=_;
//# sourceMappingURL=afterpay.cjs.js.map
